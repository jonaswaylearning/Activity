<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Chapters 1â€“8 â€” Integrated Phrases Practice ğŸ§ğŸ“š</title>
  <style>
    :root{--bg:#f7f7f8;--card:#ffffff;--muted:#666;--accent:#111;--green:#0a8f3c}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;background:var(--bg);color:var(--accent);margin:0;padding:24px}
    .container{max-width:900px;margin:0 auto}
    h1{font-size:20px;margin:0 0 6px}
    p.lead{margin:4px 0 18px;color:var(--muted)}
    .card{background:var(--card);border-radius:12px;padding:14px 16px;margin:12px 0;box-shadow:0 6px 18px rgba(18,18,18,0.04)}
    .meta{font-size:13px;color:var(--muted);margin-bottom:8px}
    .pt{font-size:15px;margin:0 0 6px;color:#333}
    .en{font-weight:700;margin:0 0 6px;color:#111}
    .translit{font-style:italic;margin:0 0 10px;color:#555}
    button{background:#111;color:#fff;border:0;padding:8px 10px;border-radius:8px;font-weight:600;cursor:pointer}
    .small{font-size:13px;padding:6px 8px;border-radius:6px}
    .row{display:flex;gap:8px;flex-wrap:wrap}
    .result{margin-top:8px;font-size:14px}
    .score{font-weight:700;color:var(--bg)} /* hidden */
    footer{color:var(--muted);font-size:13px;margin-top:18px}

    /* progress */
    .progress{display:flex;gap:6px;margin-top:10px}
    .progress .step{flex:1;height:10px;border-radius:6px;background:#eee;box-shadow:inset 0 -2px 0 rgba(0,0,0,0.03);transition:background .25s,transform .12s}
    .progress .step.filled{background:var(--green);transform:scaleY(1.03)}
    .progress .step.done{background:var(--green)}
    .badge-done{margin-left:8px;font-weight:700;color:var(--green)}

    .reset.small{background:#111;color:#fff;border:0;padding:6px 8px;border-radius:6px;font-weight:600;cursor:pointer}

    @media (prefers-color-scheme: dark){
      :root{--bg:#101214;--card:#0e1112;--muted:#9aa0a6;--accent:#e6e6e6}
      .pt{color:#e6e6e6}
      .en{color:#fff}
      .translit{color:#cfcfcf}
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Chapters 1â€“8 â€” Integrated Phrases</h1>
    <p class="lead">Click â–¶ï¸ to hear the original line, ğŸ¢ to hear it slower, and ğŸ”´ to record your pronunciation for feedback. â€” have fun! ğŸ˜Š</p>

    <!-- 1 -->
    <div class="card" data-idx="1">
      <div class="pt">ğŸ‘‹ Bom dia! Eu sou o pai de Noah.</div>
      <div class="en">ğŸ‡ºğŸ‡¸ Good morning! Iâ€™m Noahâ€™s father.</div>
      <div class="translit">gud mÃ³rning! Ã¡im nÃ´as fÃ¡dher</div>
      <div class="row">
        <button class="play small" data-text="Good morning! I'm Noah's father.">â–¶ï¸ Play</button>
        <button class="slow small" data-text="Good morning! I'm Noah's father.">ğŸ¢ Slow</button>
        <button class="rec small" data-text="Good morning! I'm Noah's father.">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="1">ğŸ” Reset</button></div>
      <div class="result" aria-live="polite"></div>
    </div>

    <!-- 2 -->
    <div class="card" data-idx="2">
      <div class="pt">ğŸ˜Š Como vocÃª estÃ¡ hoje? EstÃ¡ feliz ou triste?</div>
      <div class="en">ğŸ‡ºğŸ‡¸ How are you today? Are you happy or sad?</div>
      <div class="translit">rÃ¡u ar iu tudÃªi? ar iu rÃ©pi or ssÃ©d?</div>
      <div class="row">
        <button class="play small" data-text="How are you today? Are you happy or sad?">â–¶ï¸ Play</button>
        <button class="slow small" data-text="How are you today? Are you happy or sad?">ğŸ¢ Slow</button>
        <button class="rec small" data-text="How are you today? Are you happy or sad?">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="2">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 3 -->
    <div class="card" data-idx="3">
      <div class="pt">ğŸ’• Eu amo minha mÃ£e e meu pai.</div>
      <div class="en">ğŸ‡ºğŸ‡¸ I love my mom and my dad.</div>
      <div class="translit">ai lÃ¢v mÃ¡i mÃ¢m end mÃ¡i dÃ©d</div>
      <div class="row">
        <button class="play small" data-text="I love my mom and my dad.">â–¶ï¸ Play</button>
        <button class="slow small" data-text="I love my mom and my dad.">ğŸ¢ Slow</button>
        <button class="rec small" data-text="I love my mom and my dad.">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="3">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 4 -->
    <div class="card" data-idx="4">
      <div class="pt">ğŸ§’ Eu tenho sete anos. Eu tenho um irmÃ£o e duas irmÃ£s.</div>
      <div class="en">ğŸ‡ºğŸ‡¸ Iâ€™m seven years old. I have one brother and two sisters.</div>
      <div class="translit">Ã¡im sÃ©ven iÃ©rz ould. Ã¡i rÃ©v uÃ¢n brÃ¢dher end tchÃº sÃ­sters</div>
      <div class="row">
        <button class="play small" data-text="I'm seven years old. I have one brother and two sisters.">â–¶ï¸ Play</button>
        <button class="slow small" data-text="I'm seven years old. I have one brother and two sisters.">ğŸ¢ Slow</button>
        <button class="rec small" data-text="I'm seven years old. I have one brother and two sisters.">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="4">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 5 -->
    <div class="card" data-idx="5">
      <div class="pt">ğŸ VocÃª gosta de maÃ§Ã£s? Sim! VocÃª gosta de bananas? NÃ£o!</div>
      <div class="en">ğŸ‡ºğŸ‡¸ Do you like apples? â€” Yes, I do! Do you like bananas? â€” No, I donâ€™t!</div>
      <div class="translit">du iu lÃ¡ik Ã¡pÃ¢ls? â€“ iÃ©s, Ã¡i du! du iu lÃ¡ik banÃ©nas? â€“ nou, Ã¡i dount!</div>
      <div class="row">
        <button class="play small" data-text="Do you like apples? Yes, I do! Do you like bananas? No, I don't!">â–¶ï¸ Play</button>
        <button class="slow small" data-text="Do you like apples? Yes, I do! Do you like bananas? No, I don't!">ğŸ¢ Slow</button>
        <button class="rec small" data-text="Do you like apples? Yes, I do! Do you like bananas? No, I don't!">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="5">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 6 -->
    <div class="card" data-idx="6">
      <div class="pt">ğŸ§ƒ Eu gosto de suco, mas nÃ£o gosto de leite.</div>
      <div class="en">ğŸ‡ºğŸ‡¸ I like juice, but I donâ€™t like milk.</div>
      <div class="translit">Ã¡i lÃ¡ik djÃºs, bÃ¢t Ã¡i dount lÃ¡ik milk</div>
      <div class="row">
        <button class="play small" data-text="I like juice, but I don't like milk.">â–¶ï¸ Play</button>
        <button class="slow small" data-text="I like juice, but I don't like milk.">ğŸ¢ Slow</button>
        <button class="rec small" data-text="I like juice, but I don't like milk.">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="6">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 7 -->
    <div class="card" data-idx="7">
      <div class="pt">ğŸ¥ O que vocÃª come no cafÃ© da manhÃ£? Eu como panquecas e leite!</div>
      <div class="en">ğŸ‡ºğŸ‡¸ What do you have for breakfast? â€” I have pancakes and milk!</div>
      <div class="translit">uÃ¡t du iu rÃ©v for brÃ©kfast? â€“ Ã¡i rÃ©v pÃ©nkeiks end milk!</div>
      <div class="row">
        <button class="play small" data-text="What do you have for breakfast? I have pancakes and milk!">â–¶ï¸ Play</button>
        <button class="slow small" data-text="What do you have for breakfast? I have pancakes and milk!">ğŸ¢ Slow</button>
        <button class="rec small" data-text="What do you have for breakfast? I have pancakes and milk!">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="7">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 8 -->
    <div class="card" data-idx="8">
      <div class="pt">ğŸ•— SÃ£o 8 horas. Vamos tomar cafÃ© da manhÃ£!</div>
      <div class="en">ğŸ‡ºğŸ‡¸ Itâ€™s 8 oâ€™clock. Letâ€™s eat breakfast!</div>
      <div class="translit">its Ãªit Ã³clok. lÃ©ts Ã­t brÃ©kfast!</div>
      <div class="row">
        <button class="play small" data-text="It's 8 o'clock. Let's eat breakfast!">â–¶ï¸ Play</button>
        <button class="slow small" data-text="It's 8 o'clock. Let's eat breakfast!">ğŸ¢ Slow</button>
        <button class="rec small" data-text="It's 8 o'clock. Let's eat breakfast!">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="8">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 9 -->
    <div class="card" data-idx="9">
      <div class="pt">ğŸ§‚ Precisamos de aÃ§Ãºcar, farinha e ovos para o bolo.</div>
      <div class="en">ğŸ‡ºğŸ‡¸ We need sugar, flour, and eggs for the cake.</div>
      <div class="translit">uÃ­ nÃ­id shÃºgar, flÃ¡uer end Ã©gs for dhi keik</div>
      <div class="row">
        <button class="play small" data-text="We need sugar, flour, and eggs for the cake.">â–¶ï¸ Play</button>
        <button class="slow small" data-text="We need sugar, flour, and eggs for the cake.">ğŸ¢ Slow</button>
        <button class="rec small" data-text="We need sugar, flour, and eggs for the cake.">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="9">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <!-- 10 -->
    <div class="card" data-idx="10">
      <div class="pt">ğŸ¥° Boa noite, mamÃ£e! Eu te amo.</div>
      <div class="en">ğŸ‡ºğŸ‡¸ Good night, mom! I love you.</div>
      <div class="translit">gud nÃ¡it, mÃ¢m! Ã¡i lÃ¢v iu</div>
      <div class="row">
        <button class="play small" data-text="Good night, mom! I love you.">â–¶ï¸ Play</button>
        <button class="slow small" data-text="Good night, mom! I love you.">ğŸ¢ Slow</button>
        <button class="rec small" data-text="Good night, mom! I love you.">ğŸ”´ Record</button>
      </div>
      <div class="progress" aria-hidden="true">
        <div class="step" data-step="1"></div>
        <div class="step" data-step="2"></div>
        <div class="step" data-step="3"></div>
        <div class="step" data-step="4"></div>
        <div class="badge-done"></div>
      </div>
      <div style="margin-top:8px;text-align:right;"><button class="reset small" data-idx="10">ğŸ” Reset</button></div>
      <div class="result"></div>
    </div>

    <footer>
      Tip: best used in Chrome on Android. If mic is blocked, open the page in Chrome (â‹® â†’ Open in Chrome). ğŸ§ğŸ“š
    </footer>
  </div>

  <script>
    // CONFIG
    const REQUIRED_CORRECT = 4;
    const PASS_THRESHOLD = 65;

    // TTS
    function speak(text, rate=1){
      if(!('speechSynthesis' in window)) return alert('SpeechSynthesis not supported in this browser.');
      const u = new SpeechSynthesisUtterance(text);
      u.lang = 'en-US';
      u.rate = rate;
      const v = speechSynthesis.getVoices().find(v=>/en/.test(v.lang));
      if(v) u.voice = v;
      speechSynthesis.cancel();
      speechSynthesis.speak(u);
    }

    // helpers
    function levenshtein(a,b){a=a.toLowerCase();b=b.toLowerCase();const m=a.length,n=b.length;if(m===0)return n;if(n===0)return m;const d=Array(m+1).fill(null).map(()=>Array(n+1).fill(0));for(let i=0;i<=m;i++)d[i][0]=i;for(let j=0;j<=n;j++)d[0][j]=j;for(let i=1;i<=m;i++){for(let j=1;j<=n;j++){const cost=a[i-1]===b[j-1]?0:1;d[i][j]=Math.min(d[i-1][j]+1,d[i][j-1]+1,d[i-1][j-1]+cost);}}return d[m][n];}
    function scoreMatch(expected, actual){const dist=levenshtein(expected, actual);const maxLen=Math.max(expected.length,1);const ratio=Math.max(0,1-dist/maxLen);return Math.round(ratio*100);}    

    const Recognition = window.SpeechRecognition || window.webkitSpeechRecognition || null;

    function keyFor(idx){ return `chap1-8_sent_${idx}_count`; }
    function updateProgressUI(card, count){ const steps = Array.from(card.querySelectorAll('.progress .step')); const badge = card.querySelector('.badge-done'); steps.forEach((s, i)=>{ s.classList.remove('filled','done'); if(i < count) s.classList.add(i < REQUIRED_CORRECT-1 ? 'filled' : 'done'); }); if(count >= REQUIRED_CORRECT){ badge.textContent = 'âœ… Completed'; } else { badge.textContent = ''; } }
    function initProgressBars(){ document.querySelectorAll('.card').forEach(card=>{ const idx = card.dataset.idx; const count = parseInt(localStorage.getItem(keyFor(idx)) || '0', 10); updateProgressUI(card, count); }); }
    function handleCorrectAttempt(idx){ const k = keyFor(idx); const prev = parseInt(localStorage.getItem(k) || '0', 10); const now = Math.min(REQUIRED_CORRECT, prev + 1); localStorage.setItem(k, now); const card = document.querySelector(`.card[data-idx="${idx}"]`); if(card) updateProgressUI(card, now); }
    function resetProgress(idx){ const k = keyFor(idx); localStorage.setItem(k, 0); const card = document.querySelector(`.card[data-idx="${idx}"]`); if(card){ updateProgressUI(card, 0); const res = card.querySelector('.result'); if(res) res.textContent = ''; } }

    function showUnsupportedModal(){ const modal = document.getElementById('unsupportedModal'); modal.style.display = 'block'; modal.setAttribute('aria-hidden','false'); }
    function hideUnsupportedModal(){ const modal = document.getElementById('unsupportedModal'); modal.style.display = 'none'; modal.setAttribute('aria-hidden','true'); }

    window.addEventListener('load', ()=>{
      if(!Recognition){ setTimeout(showUnsupportedModal, 600); }

      document.querySelectorAll('.play').forEach(btn=>btn.addEventListener('click',()=>speak(btn.dataset.text,1)));
      document.querySelectorAll('.slow').forEach(btn=>btn.addEventListener('click',()=>speak(btn.dataset.text,0.75)));

      document.querySelectorAll('.reset').forEach(btn=>{ btn.addEventListener('click', ()=>{ const idx = btn.dataset.idx; if(!idx) return; if(confirm('Reset progress for this sentence?')) resetProgress(idx); }); });

      document.querySelectorAll('.rec').forEach(btn=>{ btn.addEventListener('click', ()=>{
        const card = btn.closest('.card'); const res = card.querySelector('.result'); if(!Recognition){ res.textContent = 'SpeechRecognition not supported. Use Chrome on Android.'; return; } if(btn.disabled) return; const expected = btn.dataset.text; const idx = card.dataset.idx; const recog = new Recognition(); recog.lang = 'en-US'; recog.interimResults = false; recog.maxAlternatives = 3; res.textContent = 'ğŸ™ï¸ Listening...'; try{ recog.start(); }catch(e){ res.textContent = 'Could not start mic.'; return; } recog.onresult = (ev)=>{ const transcript = ev.results[0][0].transcript; const score = scoreMatch(expected, transcript); res.innerHTML = `You said: \"<em>${transcript}</em>\" â€” ` + (score>=PASS_THRESHOLD? 'âœ… Good!':'âŒ Try again') + ` <span class=\"score\">${score}%</span>`; if(score >= PASS_THRESHOLD){ handleCorrectAttempt(idx); } recog.stop(); }; recog.onerror = (ev)=>{ res.textContent = 'Error: ' + ev.error; }; }); });

      initProgressBars();
    });
  </script>

  <!-- modal -->
  <div id="unsupportedModal" style="display:none;" aria-hidden="true">
    <div style="position:fixed;inset:0;background:rgba(0,0,0,0.35);display:flex;align-items:center;justify-content:center;z-index:1200">
      <div style="background:white;padding:16px;border-radius:12px;max-width:420px;width:92%;box-shadow:0 10px 30px rgba(0,0,0,0.15);text-align:left">
        <h3 style="margin:0 0 8px;font-size:16px">ğŸ™ï¸ Recording not available</h3>
        <p style="margin:0 0 12px;color:var(--muted)">Recording isn't supported in this browser. For full functionality (Record), open this page in <strong>Chrome on Android</strong> or on a desktop Chrome browser. You can still listen to the sentences here.</p>
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button onclick="hideUnsupportedModal()" style="background:#eee;color:#111;border:0;padding:8px 10px;border-radius:8px;cursor:pointer">Close</button>
        </div>
      </div>
    </div>
  </div>

</body>
</html>
